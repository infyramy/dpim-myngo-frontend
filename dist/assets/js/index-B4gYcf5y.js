import{b as H,r as f,c as z,o as J,e as v,f as t,g as l,u as s,w as o,h as i,F as P,k as O,i as w,j as m,t as d,n as T,a5 as W,aB as X,a as x,l as u}from"./vendor-D6Gd-AmM.js";import{p as Y,a as Z,b as ee,c as te,_ as c,e as se,g as R,h as D,i as N,j as E,q as S,r as V,d as g}from"./ui-C-FEV6Jq.js";import{a as F}from"./admin-DxRhEtpx.js";import"./deps-CXbEQKqm.js";import"./auth-DV8b8DmP.js";const le={class:"flex flex-col gap-4 md:gap-8"},ae={class:"flex items-center gap-2"},oe={class:"relative w-full overflow-auto"},ne={class:"w-full caption-bottom text-sm"},ie={class:"p-4 align-middle"},de={class:"p-4 align-middle"},re={class:"p-4 align-middle"},ue={class:"p-4 align-middle"},pe={class:"p-4 align-middle text-center"},ve={class:"p-4 align-middle text-right"},me={class:"flex justify-end gap-2"},ce={key:1},fe={colspan:"6",class:"p-8 text-center"},ge={class:"flex flex-col items-center gap-4"},_e={class:"text-lg font-medium text-muted-foreground"},xe={class:"text-sm text-muted-foreground"},ye={class:"p-4 align-middle font-medium"},be={class:"p-4 align-middle"},ke={class:"p-4 align-middle"},we={class:"p-4 align-middle"},Ae={class:"p-4 align-middle text-center"},Ce={class:"p-4 align-middle text-right"},je={class:"flex justify-end gap-2"},$e={key:0,class:"grid gap-4 py-4"},he={class:"grid grid-cols-4 gap-4"},Re={class:"col-span-3"},De={class:"grid grid-cols-4 gap-4"},Ne={class:"col-span-3"},Ee={class:"grid grid-cols-4 gap-4"},Se={class:"col-span-3"},Ve={class:"grid grid-cols-4 gap-4"},Fe={class:"col-span-3"},Le={class:"grid grid-cols-4 gap-4"},Ue={class:"col-span-3"},Be={class:"grid grid-cols-4 gap-4"},Me={class:"col-span-3"},ze={class:"grid grid-cols-4 gap-4"},Pe={class:"col-span-3"},Oe={key:0,class:"grid grid-cols-4 gap-4"},Te={class:"col-span-3"},qe={key:0,class:"py-4"},Ie={key:0,class:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full mr-2"},Ke={key:0,class:"grid gap-4 py-4"},Qe={class:"grid gap-2"},Ge={key:0,class:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full mr-2"},et=H({__name:"index",setup(He){const C=f([]),j=f(!1),p=f(!1),a=f(null),A=f(!1),y=f(!1),b=f(!1),k=f(""),$=z(()=>_.value.trim()!=="");function q(){_.value=""}function I(r){a.value=r,A.value=!0}function L(r){a.value=r,y.value=!0}function U(r){a.value=r,k.value="",b.value=!0}async function K(){if(a.value)try{p.value=!0,await F().post("/applications/approve",{id:a.value.id},!0),x.success(`Application ${a.value.fullname} approved`),y.value=!1,await h()}catch(r){console.log("Error approving application:",r),x.error("Failed to approve application")}finally{p.value=!1}}async function Q(){if(a.value){if(!k.value){x.error("Please provide a reason for rejection");return}try{p.value=!0,await F().post("/applications/reject",{id:a.value.id,reason:k.value},!0),x.success(`Application ${a.value.fullname} rejected`),b.value=!1,await h()}catch(r){console.log("Error rejecting application:",r),x.error("Failed to reject application")}finally{p.value=!1}}}const _=f(""),B=z(()=>{if(!_.value)return C.value;const r=_.value.toLowerCase();return C.value.filter(e=>e.fullname.toLowerCase().includes(r)||e.email.toLowerCase().includes(r))});async function h(){try{j.value=!0;const r=await F().get("/applications",!0);console.log("Applications:",r.data.applications),C.value=r.data.applications}catch(r){console.log("Error fetching applications:",r),x.error("Failed to load applications")}finally{j.value=!1}}return J(async()=>{await h()}),(r,e)=>(u(),v("div",le,[e[41]||(e[41]=t("div",{class:"flex items-center justify-between"},[t("h1",{class:"text-xl font-semibold md:text-2xl"},"Member Applications")],-1)),t("div",ae,[l(s(Y),{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=n=>_.value=n),placeholder:"Search by name, email or ID...",class:"max-w-sm"},null,8,["modelValue"])]),l(s(se),null,{default:o(()=>[l(s(Z),null,{default:o(()=>[l(s(ee),null,{default:o(()=>e[10]||(e[10]=[i("Pending Applications")])),_:1,__:[10]})]),_:1}),l(s(te),null,{default:o(()=>[t("div",oe,[t("table",ne,[e[16]||(e[16]=t("thead",null,[t("tr",{class:"border-b"},[t("th",{class:"h-10 px-4 text-left font-medium"},"No"),t("th",{class:"h-10 px-4 text-left font-medium"},"Name"),t("th",{class:"h-10 px-4 text-left font-medium"},"Email"),t("th",{class:"h-10 px-4 text-left font-medium"},"Apply Date"),t("th",{class:"h-10 px-4 text-center font-medium"},"Status"),t("th",{class:"h-10 px-4 text-right font-medium"},"Actions")])],-1)),t("tbody",null,[j.value?(u(),v(P,{key:0},O(5,n=>t("tr",{key:`skeleton-${n}`,class:"border-b"},[t("td",ie,[l(s(g),{class:"h-4 w-8"})]),t("td",de,[l(s(g),{class:"h-4 w-32"})]),t("td",re,[l(s(g),{class:"h-4 w-40"})]),t("td",ue,[l(s(g),{class:"h-4 w-24"})]),t("td",pe,[l(s(g),{class:"h-5 w-16 rounded-full mx-auto"})]),t("td",ve,[t("div",me,[l(s(g),{class:"h-8 w-16"}),l(s(g),{class:"h-8 w-16"}),l(s(g),{class:"h-8 w-16"})])])])),64)):B.value.length===0?(u(),v("tr",ce,[t("td",fe,[t("div",ge,[e[12]||(e[12]=t("div",{class:"text-4xl"},"ðŸ‘¥",-1)),t("div",_e,d($.value?"No applications match your search":"No applications yet"),1),t("div",xe,d($.value?"Try adjusting your search criteria or clear the filters":"Member applications will appear here once they are submitted"),1),$.value?(u(),w(s(c),{key:0,variant:"outline",onClick:q,class:"mt-2"},{default:o(()=>e[11]||(e[11]=[i(" Clear search ")])),_:1,__:[11]})):m("",!0)])])])):(u(!0),v(P,{key:2},O(B.value,(n,G)=>(u(),v("tr",{key:n.id,class:"border-b"},[t("td",ye,d(G+1),1),t("td",be,d(n.fullname),1),t("td",ke,d(n.email),1),t("td",we,d(new Date(n.apply_at).toLocaleDateString()),1),t("td",Ae,[t("span",{class:T(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",n.status==="pending"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":n.status==="approved"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"])},d(n.status.charAt(0).toUpperCase()+n.status.slice(1)),3)]),t("td",Ce,[t("div",je,[l(s(c),{variant:"ghost",size:"sm",onClick:M=>I(n)},{default:o(()=>e[13]||(e[13]=[i(" Review ")])),_:2,__:[13]},1032,["onClick"]),n.status==="pending"?(u(),w(s(c),{key:0,variant:"default",size:"sm",onClick:M=>L(n)},{default:o(()=>e[14]||(e[14]=[i(" Approve ")])),_:2,__:[14]},1032,["onClick"])):m("",!0),n.status==="pending"?(u(),w(s(c),{key:1,variant:"destructive",size:"sm",onClick:M=>U(n)},{default:o(()=>e[15]||(e[15]=[i(" Reject ")])),_:2,__:[15]},1032,["onClick"])):m("",!0)])])]))),128))])])])]),_:1})]),_:1}),l(s(V),{open:A.value,"onUpdate:open":e[4]||(e[4]=n=>A.value=n)},{default:o(()=>[l(s(R),{class:"sm:max-w-[600px]"},{default:o(()=>[l(s(D),null,{default:o(()=>[l(s(N),null,{default:o(()=>e[17]||(e[17]=[i("Application Details")])),_:1,__:[17]}),l(s(E),null,{default:o(()=>e[18]||(e[18]=[i(" Review the member application information. ")])),_:1,__:[18]})]),_:1}),a.value?(u(),v("div",$e,[t("div",he,[e[19]||(e[19]=t("div",{class:"col-span-1 text-sm font-medium"},"ID:",-1)),t("div",Re,d(a.value.id),1)]),t("div",De,[e[20]||(e[20]=t("div",{class:"col-span-1 text-sm font-medium"},"Name:",-1)),t("div",Ne,d(a.value.fullname),1)]),t("div",Ee,[e[21]||(e[21]=t("div",{class:"col-span-1 text-sm font-medium"},"Email:",-1)),t("div",Se,d(a.value.email),1)]),t("div",Ve,[e[22]||(e[22]=t("div",{class:"col-span-1 text-sm font-medium"},"MyKad Number:",-1)),t("div",Fe,d(a.value.mykad_number),1)]),t("div",Le,[e[23]||(e[23]=t("div",{class:"col-span-1 text-sm font-medium"},"Address:",-1)),t("div",Ue,d(a.value.address),1)]),t("div",Be,[e[24]||(e[24]=t("div",{class:"col-span-1 text-sm font-medium"},"Apply Date:",-1)),t("div",Me,d(new Date(a.value.apply_at).toLocaleDateString()),1)]),t("div",ze,[e[25]||(e[25]=t("div",{class:"col-span-1 text-sm font-medium"},"Status:",-1)),t("div",Pe,[t("span",{class:T(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",a.value.status==="pending"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":a.value.status==="approved"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"])},d(a.value.status.charAt(0).toUpperCase()+a.value.status.slice(1)),3)])]),a.value.rejectionReason?(u(),v("div",Oe,[e[26]||(e[26]=t("div",{class:"col-span-1 text-sm font-medium"},"Rejection Reason:",-1)),t("div",Te,d(a.value.rejectionReason),1)])):m("",!0)])):m("",!0),l(s(S),null,{default:o(()=>[l(s(c),{variant:"outline",onClick:e[1]||(e[1]=n=>A.value=!1)},{default:o(()=>e[27]||(e[27]=[i("Close")])),_:1,__:[27]}),a.value&&a.value.status==="pending"?(u(),w(s(c),{key:0,onClick:e[2]||(e[2]=n=>L(a.value))},{default:o(()=>e[28]||(e[28]=[i(" Approve ")])),_:1,__:[28]})):m("",!0),a.value&&a.value.status==="pending"?(u(),w(s(c),{key:1,variant:"destructive",onClick:e[3]||(e[3]=n=>U(a.value))},{default:o(()=>e[29]||(e[29]=[i(" Reject ")])),_:1,__:[29]})):m("",!0)]),_:1})]),_:1})]),_:1},8,["open"]),l(s(V),{open:y.value,"onUpdate:open":e[6]||(e[6]=n=>y.value=n)},{default:o(()=>[l(s(R),null,{default:o(()=>[l(s(D),null,{default:o(()=>[l(s(N),null,{default:o(()=>e[30]||(e[30]=[i("Approve Application")])),_:1,__:[30]}),l(s(E),null,{default:o(()=>e[31]||(e[31]=[i(" Are you sure you want to approve this application? ")])),_:1,__:[31]})]),_:1}),a.value?(u(),v("div",qe,[t("p",null,[e[32]||(e[32]=t("span",{class:"font-medium"},"Name:",-1)),i(" "+d(a.value.fullname),1)]),t("p",null,[e[33]||(e[33]=t("span",{class:"font-medium"},"Email:",-1)),i(" "+d(a.value.email),1)])])):m("",!0),l(s(S),null,{default:o(()=>[l(s(c),{variant:"outline",onClick:e[5]||(e[5]=n=>y.value=!1),disabled:p.value},{default:o(()=>e[34]||(e[34]=[i(" Cancel ")])),_:1,__:[34]},8,["disabled"]),l(s(c),{onClick:K,disabled:p.value},{default:o(()=>[p.value?(u(),v("div",Ie)):m("",!0),i(" "+d(p.value?"Approving...":"Approve"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),l(s(V),{open:b.value,"onUpdate:open":e[9]||(e[9]=n=>b.value=n)},{default:o(()=>[l(s(R),null,{default:o(()=>[l(s(D),null,{default:o(()=>[l(s(N),null,{default:o(()=>e[35]||(e[35]=[i("Reject Application")])),_:1,__:[35]}),l(s(E),null,{default:o(()=>e[36]||(e[36]=[i(" Please provide a reason for rejecting this application. ")])),_:1,__:[36]})]),_:1}),a.value?(u(),v("div",Ke,[t("div",null,[t("p",null,[e[37]||(e[37]=t("span",{class:"font-medium"},"Name:",-1)),i(" "+d(a.value.fullname),1)]),t("p",null,[e[38]||(e[38]=t("span",{class:"font-medium"},"Email:",-1)),i(" "+d(a.value.email),1)])]),t("div",Qe,[e[39]||(e[39]=t("label",{for:"reason",class:"text-sm font-medium"},"Rejection Reason",-1)),W(t("textarea",{id:"reason","onUpdate:modelValue":e[7]||(e[7]=n=>k.value=n),placeholder:"Provide a reason for rejection...",rows:"3",class:"flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50"},null,512),[[X,k.value]])])])):m("",!0),l(s(S),null,{default:o(()=>[l(s(c),{variant:"outline",onClick:e[8]||(e[8]=n=>b.value=!1),disabled:p.value},{default:o(()=>e[40]||(e[40]=[i(" Cancel ")])),_:1,__:[40]},8,["disabled"]),l(s(c),{variant:"destructive",onClick:Q,disabled:p.value},{default:o(()=>[p.value?(u(),v("div",Ge)):m("",!0),i(" "+d(p.value?"Rejecting...":"Reject"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]))}});export{et as default};
