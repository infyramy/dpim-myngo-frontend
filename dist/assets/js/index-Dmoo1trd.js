import{u as Y,a as P}from"./admin-DxRhEtpx.js";import{_ as p,a as _,b as v,c as x,d as i,e as g,v as E}from"./ui-C-FEV6Jq.js";import{b as H,r as b,c as B,o as I,e as r,f as a,g as t,t as d,u as e,w as l,h as c,bE as O,bb as S,b0 as F,bc as W,bF as Z,m as q,aZ as T,F as k,k as A,a as M,l as n,i as G,j as J}from"./vendor-D6Gd-AmM.js";import"./deps-CXbEQKqm.js";import"./auth-DV8b8DmP.js";const K={class:"flex flex-col gap-6 md:gap-8"},X={class:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between"},ee={class:"text-2xl font-bold md:text-3xl"},te={class:"text-muted-foreground"},se={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"},ae={key:0,class:"space-y-2"},le={key:1},oe={class:"text-2xl font-bold"},ne={class:"text-xs text-muted-foreground"},re={key:0,class:"space-y-2"},de={key:1},ie={class:"text-2xl font-bold text-amber-600"},ue={key:0,class:"space-y-2"},ce={key:1},fe={class:"text-2xl font-bold"},me={key:0,class:"space-y-2"},pe={key:1},_e={class:"text-2xl font-bold"},ve={class:"grid gap-6 lg:grid-cols-2"},xe={key:0,class:"space-y-4"},ge={class:"space-y-2"},be={key:1,class:"text-center py-8"},we={key:2,class:"space-y-4"},he={class:"space-y-1"},ye={class:"font-medium"},ke={class:"text-sm text-muted-foreground"},Ae={class:"text-xs text-muted-foreground"},Me={class:"flex items-center gap-2"},Ce={key:0,class:"space-y-4"},je={class:"space-y-2"},$e={key:1,class:"text-center py-8"},De={key:2,class:"space-y-4"},Se={class:"space-y-1"},Fe={class:"font-medium"},Ne={class:"text-sm text-muted-foreground"},Re={class:"flex items-center gap-4 text-xs text-muted-foreground"},Ve={class:"grid gap-4 md:grid-cols-3"},Le={class:"flex flex-col items-start gap-2"},Pe={class:"text-sm text-muted-foreground"},Ee={class:"flex flex-col items-start gap-2"},Be={class:"text-sm text-muted-foreground"},Oe={class:"flex flex-col items-start gap-2"},We=H({__name:"index",setup(Te){const w=q(),C=Y(),f=b({totalMembers:0,activeMembers:0,pendingApplications:0,totalProducts:0,recentMembersCount:0}),j=b([]),$=b([]),m=b(!1),h=b(!1),y=b(!1),U=B(()=>{const u=C.getUser(),s=C.getOperatorStates();return{name:(u==null?void 0:u.fullname)||"Operator",stateName:(s==null?void 0:s.state_name)||"Your State"}}),N=B(()=>m.value||h.value||y.value),z=u=>new Date(u).toLocaleDateString("en-MY",{year:"numeric",month:"short",day:"numeric"}),R=u=>{switch(u){case"active":return"success";case"pending":return"warning";case"suspended":return"destructive";default:return"secondary"}},D=async()=>{try{m.value=!0,h.value=!0,y.value=!0;const s=(await P().get("/operator-dashboard/overview",!0)).data;f.value={totalMembers:s.stats.totalMembers,activeMembers:s.stats.activeMembers,pendingApplications:s.stats.pendingApplications,totalProducts:s.stats.totalProducts,recentMembersCount:s.stats.recentMembersCount},j.value=s.recentApplications||[],$.value=s.recentMembers||[]}catch(u){console.error("Error fetching dashboard overview:",u),M.error("Failed to load dashboard data")}finally{m.value=!1,h.value=!1,y.value=!1}},Q=async u=>{try{await P().post("/applications/approve",{id:u},!0),M.success("Application approved successfully"),await D()}catch(s){console.error("Error approving application:",s),M.error("Failed to approve application")}},V=async()=>{await D(),M.success("Dashboard refreshed")};return I(async()=>{await D()}),(u,s)=>{var L;return n(),r("div",K,[a("div",X,[a("div",null,[a("h1",ee,d((L=e(C).getOperatorStates())==null?void 0:L.state_title)+" Dashboard ",1),a("p",te," Welcome back, "+d(U.value.name)+". Here's what's happening in your region. ",1)]),t(e(p),{variant:"outline",onClick:V,disabled:N.value,class:"w-full md:w-auto"},{default:l(()=>[t(e(O),{class:"mr-2 h-4 w-4"}),s[4]||(s[4]=c(" Refresh Data "))]),_:1,__:[4]},8,["disabled"])]),a("div",se,[t(e(g),null,{default:l(()=>[t(e(_),{class:"flex flex-row items-center justify-between pb-2"},{default:l(()=>[t(e(v),{class:"text-sm font-medium"},{default:l(()=>s[5]||(s[5]=[c("Total Members")])),_:1,__:[5]}),t(e(S),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(x),null,{default:l(()=>[m.value?(n(),r("div",ae,[t(e(i),{class:"h-8 w-16"}),t(e(i),{class:"h-4 w-24"})])):(n(),r("div",le,[a("div",oe,d(f.value.totalMembers),1),a("p",ne,d(f.value.activeMembers)+" active members ",1)]))]),_:1})]),_:1}),t(e(g),null,{default:l(()=>[t(e(_),{class:"flex flex-row items-center justify-between pb-2"},{default:l(()=>[t(e(v),{class:"text-sm font-medium"},{default:l(()=>s[6]||(s[6]=[c("Pending Applications")])),_:1,__:[6]}),t(e(F),{class:"h-4 w-4 text-amber-500"})]),_:1}),t(e(x),null,{default:l(()=>[m.value?(n(),r("div",re,[t(e(i),{class:"h-8 w-16"}),t(e(i),{class:"h-4 w-32"})])):(n(),r("div",de,[a("div",ie,d(f.value.pendingApplications),1),s[7]||(s[7]=a("p",{class:"text-xs text-muted-foreground"},"Awaiting your review",-1))]))]),_:1})]),_:1}),t(e(g),null,{default:l(()=>[t(e(_),{class:"flex flex-row items-center justify-between pb-2"},{default:l(()=>[t(e(v),{class:"text-sm font-medium"},{default:l(()=>s[8]||(s[8]=[c("Products Registered")])),_:1,__:[8]}),t(e(W),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(x),null,{default:l(()=>[m.value?(n(),r("div",ue,[t(e(i),{class:"h-8 w-16"}),t(e(i),{class:"h-4 w-36"})])):(n(),r("div",ce,[a("div",fe,d(f.value.totalProducts),1),s[9]||(s[9]=a("p",{class:"text-xs text-muted-foreground"},"From all active members",-1))]))]),_:1})]),_:1}),t(e(g),null,{default:l(()=>[t(e(_),{class:"flex flex-row items-center justify-between pb-2"},{default:l(()=>[t(e(v),{class:"text-sm font-medium"},{default:l(()=>s[10]||(s[10]=[c("Recent Activity")])),_:1,__:[10]}),t(e(Z),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(x),null,{default:l(()=>[m.value?(n(),r("div",me,[t(e(i),{class:"h-8 w-16"}),t(e(i),{class:"h-4 w-28"})])):(n(),r("div",pe,[a("div",_e,d(f.value.recentMembersCount),1),s[11]||(s[11]=a("p",{class:"text-xs text-muted-foreground"},"New members this week",-1))]))]),_:1})]),_:1})]),a("div",ve,[t(e(g),null,{default:l(()=>[t(e(_),{class:"flex flex-row items-center justify-between"},{default:l(()=>[t(e(v),null,{default:l(()=>s[12]||(s[12]=[c("Recent Applications")])),_:1,__:[12]}),t(e(p),{variant:"ghost",size:"sm",onClick:s[0]||(s[0]=o=>e(w).push("/operator/applications")),class:"text-sm"},{default:l(()=>[t(e(T),{class:"mr-1 h-4 w-4"}),s[13]||(s[13]=c(" View All "))]),_:1,__:[13]})]),_:1}),t(e(x),null,{default:l(()=>[h.value?(n(),r("div",xe,[(n(),r(k,null,A(3,o=>a("div",{key:o,class:"flex items-center justify-between p-4 border rounded-lg"},[a("div",ge,[t(e(i),{class:"h-4 w-32"}),t(e(i),{class:"h-3 w-48"})]),t(e(i),{class:"h-8 w-20"})])),64))])):j.value.length===0?(n(),r("div",be,[t(e(F),{class:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),s[14]||(s[14]=a("p",{class:"text-muted-foreground"},"No pending applications",-1))])):(n(),r("div",we,[(n(!0),r(k,null,A(j.value,o=>(n(),r("div",{key:o.id,class:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors"},[a("div",he,[a("p",ye,d(o.fullname),1),a("p",ke,d(o.email),1),a("p",Ae," Applied "+d(z(o.apply_at)),1)]),a("div",Me,[t(e(E),{variant:R(o.status)},{default:l(()=>[c(d(o.status),1)]),_:2},1032,["variant"]),o.status==="pending"?(n(),G(e(p),{key:0,size:"sm",onClick:Ue=>Q(o.id)},{default:l(()=>s[15]||(s[15]=[c(" Approve ")])),_:2,__:[15]},1032,["onClick"])):J("",!0)])]))),128))]))]),_:1})]),_:1}),t(e(g),null,{default:l(()=>[t(e(_),{class:"flex flex-row items-center justify-between"},{default:l(()=>[t(e(v),null,{default:l(()=>s[16]||(s[16]=[c("Recent Members")])),_:1,__:[16]}),t(e(p),{variant:"ghost",size:"sm",onClick:s[1]||(s[1]=o=>e(w).push("/operator/members")),class:"text-sm"},{default:l(()=>[t(e(T),{class:"mr-1 h-4 w-4"}),s[17]||(s[17]=c(" View All "))]),_:1,__:[17]})]),_:1}),t(e(x),null,{default:l(()=>[y.value?(n(),r("div",Ce,[(n(),r(k,null,A(3,o=>a("div",{key:o,class:"flex items-center justify-between p-4 border rounded-lg"},[a("div",je,[t(e(i),{class:"h-4 w-32"}),t(e(i),{class:"h-3 w-48"}),t(e(i),{class:"h-3 w-24"})]),t(e(i),{class:"h-6 w-16"})])),64))])):$.value.length===0?(n(),r("div",$e,[t(e(S),{class:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),s[18]||(s[18]=a("p",{class:"text-muted-foreground"},"No members found",-1))])):(n(),r("div",De,[(n(!0),r(k,null,A($.value,o=>(n(),r("div",{key:o.id,class:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors"},[a("div",Se,[a("p",Fe,d(o.name),1),a("p",Ne,d(o.email),1),a("div",Re,[a("span",null,d(o.businessesCount||0)+" businesses",1),a("span",null,d(o.productsCount||0)+" products",1)])]),t(e(E),{variant:R(o.status)},{default:l(()=>[c(d(o.status),1)]),_:2},1032,["variant"])]))),128))]))]),_:1})]),_:1})]),t(e(g),null,{default:l(()=>[t(e(_),null,{default:l(()=>[t(e(v),null,{default:l(()=>s[19]||(s[19]=[c("Quick Actions")])),_:1,__:[19]})]),_:1}),t(e(x),null,{default:l(()=>[a("div",Ve,[t(e(p),{variant:"outline",class:"justify-start h-auto p-6",onClick:s[2]||(s[2]=o=>e(w).push("/operator/applications"))},{default:l(()=>[a("div",Le,[t(e(F),{class:"h-5 w-5 text-amber-500"}),a("div",null,[s[20]||(s[20]=a("p",{class:"font-medium"},"Review Applications",-1)),a("p",Pe,d(f.value.pendingApplications)+" pending ",1)])])]),_:1}),t(e(p),{variant:"outline",class:"justify-start h-auto p-6",onClick:s[3]||(s[3]=o=>e(w).push("/operator/members"))},{default:l(()=>[a("div",Ee,[t(e(S),{class:"h-5 w-5 text-blue-500"}),a("div",null,[s[21]||(s[21]=a("p",{class:"font-medium"},"Manage Members",-1)),a("p",Be,d(f.value.totalMembers)+" total members ",1)])])]),_:1}),t(e(p),{variant:"outline",class:"justify-start h-auto p-6",onClick:V,disabled:N.value},{default:l(()=>[a("div",Oe,[t(e(O),{class:"h-5 w-5 text-green-500"}),s[22]||(s[22]=a("div",null,[a("p",{class:"font-medium"},"Refresh Data"),a("p",{class:"text-sm text-muted-foreground"},"Update dashboard")],-1))])]),_:1},8,["disabled"])])]),_:1})]),_:1})])}}});export{We as default};
